tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
wt.w
data.frame(wt.w)
htmlTable(data.frame(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2),
rnames = T,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
as.data.frame.matrix(wt.w)
htmlTable(as.data.frame.matrix(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2),
rnames = T,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
kable(as.data.frame.matrix(wt.w))
htmlTable(as.data.frame.matrix(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(3, 2),
rnames = T,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
wt.w<-cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
)
wt.t$"Day of Week"<-row.names(wt.w)
wt.w<-cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
)
wt.w$"Day of Week"<-row.names(wt.w)
wt.w
wt.w$DayOfWeek"<-row.names(wt.w)
)
wt.w$DayOfWeek"<-row.names(wt.w)
wt.w$DayOfWeek<-row.names(wt.w)
htmlTable(as.data.frame.matrix(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
wt.w<-cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
)
wt.w$DayOfWeek<-row.names(wt.w)
htmlTable(as.data.frame.matrix(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(1,2, 2),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
wt.w<-cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
)
row.names(wt.w)
wt.w$DayOfWeek<-row.names(wt.w)
wt.w<-data.frame(cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
))
wt.w$DayOfWeek<-row.names(wt.w)
wt.w$"DayOfWeek"<-row.names(wt.w)
wt.w$"Day O fWeek"<-row.names(wt.w)
wt.w<-data.frame(cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
))
wt.w$"Day O fWeek"<-row.names(wt.w)
htmlTable(as.data.frame.matrix(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(1,2, 2),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(as.data.frame.matrix(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(as.data.frame.matrix(wt.w),
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(3, 2),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(wt.w,
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(3, 2),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(wt.w,
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(3, 2),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(wt.w,
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2,1),
rnames = F,
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
wt.w<-data.frame(cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
))
wt.w
wt.w<-(cbind(
round(confint(svyby(~pw,by=~DoW,uk.s,svymean))),
round(confint(svyby(~pw,by=~DoW,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
))
htmlTable(wt.w,
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2,1),
rnames = row.names(wt.w),
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(wt.w,
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2,),
rnames = row.names(wt.w),
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(wt.w,
cgroup = c("All 16+", "16+ working"),
n.cgroup = c(2, 2),
rnames = row.names(wt.w),
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
htmlTable(wt.w,
cgroup = c("All 16+^*", "16+ working"),
n.cgroup = c(2, 2),
rnames = row.names(wt.w),
caption="Table 1 Weekly working time",
tfoot="Median daily working time of  all respondents aged 16 (minutes per day, weighted for non-response and adjusted for survey design")
pt2
pt2<-svyby(~pw,by=~DoW+FtPtWk.f,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)
pt2$lower<-pt2$pw-1.96*pt2$se.pw
pt2$upper<-pt2$pw+1.96*pt2$se.pw
g<-ggplot(pt2[pt2$FtPtWk.f!="Other",], aes(y=DoW, x=pw)) +        # ggplot2 plot with confidence intervals
geom_point() +
geom_errorbarh(aes(xmin = lower, xmax = upper),linewidth = 1,height=.2)+
xlab("Minutes per day")+ylab("")+
facet_wrap(~FtPtWk.f,scales="free")
ukd<-read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_diary_ep_long.dta")
dim(ukd)
names(ukd)
table(ukd$HhOut)
table(as_factor(ukd$HhOut))
table(as_factor(ukd$IndOut))
table(ukd$IndOut)
ukd<-read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_diary_ep_long.dta")%>%
filter(IndOut==11) ### Retaining only full (diary + interviews) records
table(is.na(ukd$serial))
table(is.na(ukd$persno))
table(is.na(ukd$persnum))
names(ukd)
table(is.na(ukd$pnum))
table(is.na(ukd$daynum))
ls(uk)
table(uk$dmonth)
table(as_factor(uk$dmonth))
svyby(~pw,by=~DoW+FtPtWk.f,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)
svyby(~pw,by=~DoW+dmonth,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)
svyby(~pw,by=~dmonth,uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)
wt.m<-(cbind(
round(confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svymean))),
round(confint(svyby(~pw,by=~as_factor(dmonth),uk.s0,svyquantile,quantiles = .5,ci=TRUE,se=ci)))
))
wt.m
confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svymean)
)
confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svytotal))
library(lubridate)
minutes_to_period(1000000000)
seconds_to_period(1000000000)
confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svymean)
)
confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svymean))*60
seconds_to_period(confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svymean))*60)
round(seconds_to_period(confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svymean))*60))
round(seconds_to_period(confint(svyby(~pw,by=~as_factor(dmonth),uk.s,svytotal))*60))
table(as_factor(ukd$main))
table(as_factor(ukd$ACT1))
names(ukd)
table(as_factor(ukd$whatdoing))
table((ukd$whatdoing))
names(ukd)
ukd$pw<-ifelse(ukd$whatdoing>=1000 & ukd<=1399,ukd$eptime,0)
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd<=1399,ukd$eptime,0)
table(ukd$pw.e)
ukd<-read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_diary_ep_long.dta")%>%
filter(IndOut==11) ### Retaining only full (diary + interviews) records
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd<=1399,ukd$eptime,0)
ukd%>%group_by(serial,pnum,daynum)%>%mutate(pw.d=sum(pw.e))
ukd<-ukd%>%group_by(serial,pnum,daynum)%>%mutate(pw.d=sum(pw.e))
table(ukd$pw.e)
table(ukd$pw.d)
names(ukd)
table(ukd$WhereWhen)
attr(ukd$WhereWhen,"both")
attr(ukd$WhereWhen,"labels")
help(case_when)
ukd$wh.e<-case_when(ukd$WhereWhen==11 |  ukd$WhereWhen==12 ~ "Home",
ukd$WhereWhen==13 ~ "Workplace",
.default = "Elsewhere")
attr(ukd$WhereWhen,"labels")
names(ukd)
attr(ukd$WithAlone,"labels")
attr(ukd$Device,"labels")
ukd<-ukd%>%<-mutate(
ukd<-ukd%<%mutate(
wh.e=case_when(WhereWhen==11 |  WhereWhen==12 ~ "Home",
WhereWhen==13 ~ "Workplace",
.default = "Elsewhere"),
pw.e=case_when((whatdoing>=1000 & ukd<=1399) ~ eptime,
.default =0),
pwa.e=case_when((whatdoing>=1000 & ukd<=1399) & WithAlone==1 ~ eptime,
.default =0),
pwna.e=case_when((whatdoing>=1000 & ukd<=1399) & WithAlone==0 ~ eptime,
.default = 0),
pwd.e=case_when((whatdoing>=1000 & ukd<=1399) & Device==1 ~ eptime,
.default = 0),
pwnd.e=case_when((whatdoing>=1000 & ukd<=1399) & Device==0 ~ eptime,
.default = 0)
)
library(dplyr)
ukd<-ukd%<%mutate(
wh.e=case_when(WhereWhen==11 |  WhereWhen==12 ~ "Home",
WhereWhen==13 ~ "Workplace",
.default = "Elsewhere"),
pw.e=case_when((whatdoing>=1000 & ukd<=1399) ~ eptime,
.default =0),
pwa.e=case_when((whatdoing>=1000 & ukd<=1399) & WithAlone==1 ~ eptime,
.default =0),
pwna.e=case_when((whatdoing>=1000 & ukd<=1399) & WithAlone==0 ~ eptime,
.default = 0),
pwd.e=case_when((whatdoing>=1000 & ukd<=1399) & Device==1 ~ eptime,
.default = 0),
pwnd.e=case_when((whatdoing>=1000 & ukd<=1399) & Device==0 ~ eptime,
.default = 0)
)
ukd<-ukd%>%mutate(
wh.e=case_when(WhereWhen==11 |  WhereWhen==12 ~ "Home",
WhereWhen==13 ~ "Workplace",
.default = "Elsewhere"),
pw.e=case_when((whatdoing>=1000 & ukd<=1399) ~ eptime,
.default =0),
pwa.e=case_when((whatdoing>=1000 & ukd<=1399) & WithAlone==1 ~ eptime,
.default =0),
pwna.e=case_when((whatdoing>=1000 & ukd<=1399) & WithAlone==0 ~ eptime,
.default = 0),
pwd.e=case_when((whatdoing>=1000 & ukd<=1399) & Device==1 ~ eptime,
.default = 0),
pwnd.e=case_when((whatdoing>=1000 & ukd<=1399) & Device==0 ~ eptime,
.default = 0)
)
ukd<-ukd%>%mutate(
wh.e=case_when(WhereWhen==11 |  WhereWhen==12 ~ "Home",
WhereWhen==13 ~ "Workplace",
.default = "Elsewhere"),
pw.e=case_when((whatdoing>=1000 & whatdoing<=1399) ~ eptime,
.default =0),
pwa.e=case_when((whatdoing>=1000 & whatdoing<=1399) & WithAlone==1 ~ eptime,
.default =0),
pwna.e=case_when((whatdoing>=1000 & whatdoing<=1399) & WithAlone==0 ~ eptime,
.default = 0),
pwd.e=case_when((whatdoing>=1000 & whatdoing<=1399) & Device==1 ~ eptime,
.default = 0),
pwnd.e=case_when((whatdoing>=1000 & whatdoing<=1399) & Device==0 ~ eptime,
.default = 0)
)
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd<=1399,ukd$eptime,0)
ukd$wh.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==11 |  ukd$WhereWhen==12),ukd$eptime,0)
ukd$ww.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==13),ukd$eptime,0)
ukd$we.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & !(ukd$WhereWhen>=11 & ukd$WhereWhen<=13),ukd$eptime,0)
ukd$pwa.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==1,ukd$eptime,0)
ukd$pwna.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==0,ukd$eptime,0)
ukd$pwd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==1,ukd$eptime,0)
ukd$pwnd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==0,ukd$eptime,0)
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd<=1399,ukd$eptime,0)
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd<=1399,ukd$eptime,0)
dim(ukd)
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd$whatdoing<=1399,ukd$eptime,0)
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd$whatdoing<=1399,ukd$eptime,0)
ukd$wh.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==11 |  ukd$WhereWhen==12),ukd$eptime,0)
ukd$ww.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==13),ukd$eptime,0)
ukd$we.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & !(ukd$WhereWhen>=11 & ukd$WhereWhen<=13),ukd$eptime,0)
ukd$wa.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==1,ukd$eptime,0)
ukd$wna.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==0,ukd$eptime,0)
ukd$wd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==1,ukd$eptime,0)
ukd$wnd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==0,ukd$eptime,0)
ukd<-ukd%>%group_by(serial,pnum,daynum)%>%
mutate(pw.d=sum(pw.e),
wh.d=sum(wh.e),
we.d=sum(ww.e),
we.d=sum(we.e),
wa.d=sum(wa.e),
wna.d=sum(wna.e),
wd.d=sum(wd.e),
wnd.d=sum(wnd.e)
)
ukd<-read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_diary_ep_long.dta")%>%
filter(IndOut==11) ### Retaining only full (diary + interviews) records
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd$whatdoing<=1399,ukd$eptime,0)
ukd$wh.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==11 |  ukd$WhereWhen==12),ukd$eptime,0)
ukd$ww.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==13),ukd$eptime,0)
ukd$we.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & !(ukd$WhereWhen>=11 & ukd$WhereWhen<=13),ukd$eptime,0)
ukd$wa.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==1,ukd$eptime,0)
ukd$wna.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==0,ukd$eptime,0)
ukd$wd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==1,ukd$eptime,0)
ukd$wnd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==0,ukd$eptime,0)
ukd<-ukd%>%group_by(serial,pnum,daynum)%>%
mutate(pw.d=sum(pw.e),
wh.d=sum(wh.e),
we.d=sum(ww.e),
we.d=sum(we.e),
wa.d=sum(wa.e),
wna.d=sum(wna.e),
wd.d=sum(wd.e),
wnd.d=sum(wnd.e)
)%>%ungroup()
names(ukd)
ls(ukd)
ukd<-read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_diary_ep_long.dta")%>%
filter(IndOut==11 & !is.na(dia_wt_a) & !is.na(DiaryDay_Act) ) ### Retaining only full (diary + interviews) records
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd$whatdoing<=1399,ukd$eptime,0)
ukd$wh.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==11 |  ukd$WhereWhen==12),ukd$eptime,0)
ukd$ww.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==13),ukd$eptime,0)
ukd$we.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & !(ukd$WhereWhen>=11 & ukd$WhereWhen<=13),ukd$eptime,0)
ukd$wa.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==1,ukd$eptime,0)
ukd$wna.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==0,ukd$eptime,0)
ukd$wd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==1,ukd$eptime,0)
ukd$wnd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==0,ukd$eptime,0)
ukd<-ukd%>%group_by(serial,pnum,daynum)%>%
mutate(pw.d=sum(pw.e),
wh.d=sum(wh.e),
we.d=sum(ww.e),
we.d=sum(we.e),
wa.d=sum(wa.e),
wna.d=sum(wna.e),
wd.d=sum(wd.e),
wnd.d=sum(wnd.e)
)%>%ungroup()
names(ukd)
test<-ukd%>% select(serial,pnum,daynum,pw.d:wnd.d)
dim(test)
uk<-merge(ukd%>% select(serial,pnum,DVAge,psu,strata,pw.d:wnd.d)
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
uk<-merge(ukd%>% select(serial,pnum,DVAge,psu,strata,pw.d:wnd.d),
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
by=c("serial","pnum","DVAge","psu","strata"),
all.x=T,all.y=F)
library(haven)
library(dplyr)
library(survey)
library(htmlTable)
library(ggplot2)
options(survey.lonely.psu="adjust")
ukd<-read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_diary_ep_long.dta")%>%
filter(IndOut==11 & !is.na(dia_wt_a) & !is.na(DiaryDay_Act) ) ### Retaining only full (diary + interviews) records
ukd$pw.e<-ifelse(ukd$whatdoing>=1000 & ukd$whatdoing<=1399,ukd$eptime,0)
ukd$wh.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==11 |  ukd$WhereWhen==12),ukd$eptime,0)
ukd$ww.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & (ukd$WhereWhen==13),ukd$eptime,0)
ukd$we.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & !(ukd$WhereWhen>=11 & ukd$WhereWhen<=13),ukd$eptime,0)
ukd$wa.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==1,ukd$eptime,0)
ukd$wna.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$WithAlone==0,ukd$eptime,0)
ukd$wd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==1,ukd$eptime,0)
ukd$wnd.e=ifelse((ukd$whatdoing>=1000 & ukd$whatdoing<=1399) & ukd$Device==0,ukd$eptime,0)
ukd<-ukd%>%group_by(serial,pnum,daynum)%>%
mutate(pw.d=sum(pw.e),
wh.d=sum(wh.e),
we.d=sum(ww.e),
we.d=sum(we.e),
wa.d=sum(wa.e),
wna.d=sum(wna.e),
wd.d=sum(wd.e),
wnd.d=sum(wnd.e)
)%>%ungroup()
uk<-merge(ukd%>% select(serial,pnum,DVAge,psu,strata,pw.d:wnd.d),
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
by=c("serial","pnum","DVAge","psu","strata"),
all.x=T,all.y=F)
#names(uk)<-tolower(names(uk))
uk$FtPtWk.f<-as_factor(uk$FtPtWk)
levels(uk$FtPtWk.f)[5:7]<-c("Other","Full-time","Part-time")
uk$DoW<-factor(as_factor(uk$DiaryDay_Act),levels=levels((as_factor(uk$DiaryDay_Act)))[c(5:10,4,1:3)])
dim(uk)
table(uk$DiaryDay_Act)
ls(uk)
uk<-merge(ukd%>% select(serial,pnum,DVAge,psu,strata,DiaryDay_Act,pw.d:wnd.d),
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
by=c("serial","pnum","DVAge","psu","strata"),
all.x=T,all.y=F)
#names(uk)<-tolower(names(uk))
uk$FtPtWk.f<-as_factor(uk$FtPtWk)
levels(uk$FtPtWk.f)[5:7]<-c("Other","Full-time","Part-time")
uk$DoW<-factor(as_factor(uk$DiaryDay_Act),levels=levels((as_factor(uk$DiaryDay_Act)))[c(5:10,4,1:3)])
uk.s<-svydesign(id=~psu,strata=~strata,weights =~dia_wt_a,data=uk%>%filter(DVAge>16) )
table(uk$daynum)
table(ukd$daynum)
uk<-merge(ukd%>%
select(serial,pnum,DVAge,psu,strata,DiaryDay_Act,pw.d:wnd.d)%>%
filter(daynum==1),
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
by=c("serial","pnum","DVAge","psu","strata"),
all.x=T,all.y=F)
uk<-merge(ukd%>%
filter(daynum==1)%>%
select(serial,pnum,DVAge,psu,strata,DiaryDay_Act,pw.d:wnd.d),
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
by=c("serial","pnum","DVAge","psu","strata"),
all.x=T,all.y=F)
names(ukd)
ls(ukd)
uk<-merge(ukd%>%
filter(epnum==1)%>%
select(serial,pnum,DVAge,psu,strata,DiaryDay_Act,pw.d:wnd.d),
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
by=c("serial","pnum","DVAge","psu","strata"),
all.x=T,all.y=F)
uk<-merge(ukd%>%
filter(epnum==1)%>%
select(serial,pnum,DVAge,psu,strata,daynum,DiaryDay_Act,pw.d:wnd.d),
read_dta("/home/piet/Dropbox/work/CTUR/Data/UKTUS/2015/UKDS/UKDA-8128-stata11_se/stata11_se/uktus15_individual.dta"),
by=c("serial","pnum","DVAge","psu","strata"),
all.x=T,all.y=F)
uk$FtPtWk.f<-as_factor(uk$FtPtWk)
levels(uk$FtPtWk.f)[5:7]<-c("Other","Full-time","Part-time")
uk$DoW<-factor(as_factor(uk$DiaryDay_Act),levels=levels((as_factor(uk$DiaryDay_Act)))[c(5:10,4,1:3)])
uk.s<-svydesign(id=~psu,strata=~strata,weights =~dia_wt_a,data=uk%>%filter(DVAge>16) )
ls(uk)
getwd()
setwd("/home/piet/Dropbox/work/UKDS/RGuide/UKDS_RGuide/")
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
help(Sys.Date())
Sys.Date()
??Sys.Date()
format(Sys.time(), "%a %b %d %X %Y")
format(Sys.Date(), "%a %b %d %X %Y")
format(Sys.Date(), "%a %b %d %Y")
format(Sys.Date(), " %b %d %Y")
format(Sys.Date(), "%d %b  %Y")
bookdown::render_book()
bookdown::render_book()
format(Sys.Date(), "%d %b  %Y")
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
format(Sys.Date())
bookdown::render_book()
, "%d %b  %Y"
format(Sys.Date())
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
format(Sys.Date(), "%d %b  %Y")
format(Sys.Date(), "%d%b  %Y")
format(Sys.Date(), "%d%b%Y")
format(Sys.Date(), "%d %b %Y")
format(Sys.Date(), "%d %b %Y")
bookdown::render_book()
bookdown::render_book()
help(format)
Date()
date()
help("date")
help("date")
day(date())
month(date())
month.name()
month()
weekdays.Date()
weekdays.Date(date())
weekdays(date())
Date(date())
as.Date(date())
date(0)
date()
substr(date(), 7,9)
substr(date(), 5,9)
substr(date(), 5,8)
substr(date(), 5,7)
c(substr(date(), 9,11),substr(date(), 5,7),)
c(substr(date(), 9,11),substr(date(), 5,7),substr(date(), 10,13))
paste0(substr(date(), 9,11),substr(date(), 5,7),substr(date(), 10,13))
paste0(substr(date(), 9,11),substr(date(), 5,6),substr(date(), 10,13))
paste0(substr(date(), 9,11),substr(date(), 5,8),substr(date(), 15,17))
paste0(substr(date(), 9,11),substr(date(), 5,8),substr(date(), 23,27))
paste0(substr(date(), 9,11),substr(date(), 5,8),substr(date(), 21,27))
paste0(substr(date(), 9,11),substr(date(), 5,8),substr(date(), 21,26))
paste0(substr(date(), 9,11),substr(date(), 5,8),substr(date(), 21,25))
paste0(substr(date(), 9,11),substr(date(), 5,8),substr(date(), 21,24))
bookdown::render_book()
