{
  "hash": "1f05573395092aa8a729988f8d158e1d",
  "result": {
    "markdown": "# Graphs and plots\n\n::: {.cell hash='Graphs_cache/html/setup5_7d5efc9260fc72e6fe243bba492a4546'}\n\n:::\n\nThere are two main ways to produce graphs in R: either by using the straightforward but rather basic plotting commands from the Base package, or the more complex and nicer looking functions from the `ggplot` package. \n\n## Distributional graphs for continuous variables\nGraphs such as histograms or box plots are a convenient way to gain a quick overview of the distribution of a variable and are easy  to produce. Go back to the BSA data, we can plot the distribution of left-right political orientations scores with the `hist()` command. \n\n\n::: {.cell hash='Graphs_cache/html/7.1_3efc5671a6e1280cbe06acc556c6fbbd'}\n\n```{.r .cell-code}\nhist(bsa$leftrigh,freq=FALSE)\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.1-1.png){fig-alt='Unformatted histogram of left-right political orientations scores' width=672}\n:::\n:::\n\n\nThe graphs appear  visible in the ‘Plot’ tab on the right hand side of the R Studio window. It shows us that political orientations are slightly skewed towards the left. The `freq=FALSE` option requires the y-axis to be expressed in terms of proportions rather than frequencies.\n\nTitles and labels can easily be added:\n  \n\n::: {.cell hash='Graphs_cache/html/7.2_0aac5eeea97ddff437cef471db5a49e9'}\n\n```{.r .cell-code}\nhist(bsa$leftrigh,\n     freq=FALSE,\n     main=\"Histogram of political orientations\",\n     ylab=\"Proportions\",\n     xlab=\"Left-right political orientations score\")\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.2-1.png){fig-alt='Histogram of left vs right political orientations, with title and y axis labels' width=672}\n:::\n:::\n\n\nNote that `main`, `ylab` and `xlab` can be used with any Base R plot commands. \n\nWe can also produce a box and whisker plot of the same variable:\n\n::: {.cell hash='Graphs_cache/html/7.3_b9359acd02c55d4edef0245e9b42fbf3'}\n\n```{.r .cell-code}\nboxplot(bsa$leftrigh,\n        main=\"Box and whisker plot of political orientations\",\n        ylab=\"Left-right political orientations score\"\n)\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.3-1.png){fig-alt='Box and whisker plot of left vs right political orientations, with title and y axis labels' width=672}\n:::\n:::\n\n\nThe generic `plot()` command produces one or two-way scatterplots:\n  \n\n::: {.cell hash='Graphs_cache/html/7.4.1_f7e98be05578157585cdeb074de96b0b'}\n\n```{.r .cell-code}\nplot(bsa$leftrigh) ### One way scatter plot of left-right political orientations score\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.4.1-1.png){fig-alt='Raw scatterplot of left-right political orientations' width=672}\n:::\n:::\n\n::: {.cell hash='Graphs_cache/html/7.4.2_126697892633c40d1978fa4c934af68d'}\n\n```{.r .cell-code}\nplot(bsa$leftrigh,bsa$libauth) \n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.4.2-1.png){fig-alt='Raw scatterplot of left-right political orientations vs authoritarianism score' width=672}\n:::\n:::\n\n\nThe second graph shows us that there is little association between the two variables. However,  slightly fewer respondents simultaneously score  high on the authoritarianism and left vs right scales.  \n\n## Plotting categorical variables\n\nThe generic `plot()` function provides a quick way to produce bar plots of categorical data. For example, we can examine the distribution of political party affiliations (`Politics` variable) which is a factor (ie categorical) variable. Some preliminary abbreviating of the factor levels are required in order for them to be displayed properly. \n\n\n::: {.cell hash='Graphs_cache/html/7.5_3f614ef83bcd52a834ac07c219358d0e'}\n\n```{.r .cell-code}\nlevels(bsa$PartyId2) ## The third and fourth factor levels are a bit long\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Conservative\"     \"Labour\"           \"Liberal Democrat\" \"Other party\"     \n[5] \"None\"             \"Green Party\"     \n```\n:::\n\n```{.r .cell-code}\nlevels(bsa$PartyId2)<-c(\"Con\",\"Lab\",\"Lib Dems\",\"Other\",\"None\", \"Greens\") \nplot(bsa$PartyId2)\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.5-1.png){fig-alt='Default frequency bar plot of political party affiliation using the plot command' width=672}\n:::\n:::\n\n\nMore advanced plots require the barplot() function, which can be used in conjunction with table(). Whereas table() creates the data that will be plotted, barplot() does the actual plotting. For instance, we can produce the same bar plot, but this time with percentages, by creating a frequency table as we did above in Section 5.2, then plot it.\n\n\n::: {.cell hash='Graphs_cache/html/7.6_36bf17db600e152bf3280e718e5aa72f'}\n\n```{.r .cell-code}\nparty.tab<-round(100*prop.table(\n  table(bsa$PartyId2)\n),\n1)\n\nparty.tab\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Con      Lab Lib Dems    Other     None   Greens \n    33.5     39.2      6.4      5.1     13.7      2.1 \n```\n:::\n\n```{.r .cell-code}\nbarplot(party.tab,\n        main=\"Political party affiliation\",\n        ylab=\"Percent\")\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.6-1.png){fig-alt='Neater frequency bar plot of political party affiliation using the barplot command' width=672}\n:::\n:::\n\n\nWe can go further and create plots for two-way contingency tables of party affiliation by gender. This time we will do it in a single command:\n  \n\n::: {.cell hash='Graphs_cache/html/7.7_50e7180794bc8094cebe0fa6e79d43e4'}\n\n```{.r .cell-code}\nbarplot(\n  round(100*prop.table(\n    table(bsa$Rsex,bsa$PartyId2),\n    2),              ## Column % (here, gender)\n    1),               ## Rounded to 1 decimal\n  beside = T,     ## Side-by-side bars   \n  main=\"Political party affiliation by gender\",\n  ylab=\"Percent\")\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.7-1.png){fig-alt='Two-way frequency bar plot of political party affiliation by gender using the barplot command' width=672}\n:::\n:::\n\n\n## More advanced plots\nSocial science research often requires more advanced plots in order to conduct more complex analyses, for instance comparing the mean or median value of a continuous outcome across two or more categorical variables. The `ggplot` package  provides one of the most advanced set of tools for plotting data  currently available. A few examples are provided below.\n\n\n***Political party affiliation by highest qualification and gender***\n  We would like to look at how differences in political party affiliations vary by gender and whether respondents have a degree-level education.\n\nLet us first prepare the data: we need to create the table of result, the proportion of degree vs non degree holders by gender and political party. This is a three-way contingency table, that we can obtain with `ftable()` as shown in Section 5.2, combined with `prop.table()` for the computation of proportions and `round()`.\nAs they are more straightforward to handle in `ggplot`, we convert the table object created by ftable into a data frame. Although we can specify titles and axis labels  in the plotting command, it is preferable  to keep things simple here and have them already in the the data.   \nRather than using the full range of educational achievements recorded in `HEdQual3`, we would like instead to have a dichotomic variable between degree holders and non degree holders. Adding it directly in the ftable command as a boolean expression return a dichotomic variable: \"TRUE\" for Degree educated respondents, and \"FALSE\" for everyone else. We just need to change the levels of this factor variable to make them more intelligible. Finally we change the variable names in our data frame. \n\n\n::: {.cell hash='Graphs_cache/html/7.8_fc4a2b7fc7aff91ae7462fa90f6a11ee'}\n\n```{.r .cell-code}\npa<-round(100*prop.table((ftable(bsa$PartyId2,bsa$Rsex,(bsa$HEdQual3==\"Degree\"))),1),1)\npa<-data.frame(pa)\nlevels(pa$Var3)<-c(\"Below\",\"Degree\")\nnames(pa)<-c(\"Affiliation\",\"Gender\",\"Education\",\"Percent\")\npa\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Affiliation Gender Education Percent\n1          Con   Male     Below    72.7\n2          Lab   Male     Below    70.1\n3     Lib Dems   Male     Below    50.0\n4        Other   Male     Below    86.5\n5         None   Male     Below    88.8\n6       Greens   Male     Below    43.3\n7          Con Female     Below    82.6\n8          Lab Female     Below    67.3\n9     Lib Dems Female     Below    54.4\n10       Other Female     Below    74.7\n11        None Female     Below    83.9\n12      Greens Female     Below    48.9\n13         Con   Male    Degree    27.3\n14         Lab   Male    Degree    29.9\n15    Lib Dems   Male    Degree    50.0\n16       Other   Male    Degree    13.5\n17        None   Male    Degree    11.2\n18      Greens   Male    Degree    56.7\n19         Con Female    Degree    17.4\n20         Lab Female    Degree    32.7\n21    Lib Dems Female    Degree    45.6\n22       Other Female    Degree    25.3\n23        None Female    Degree    16.1\n24      Greens Female    Degree    51.1\n```\n:::\n:::\n\nWe are now ready to plot the data.  the `ggplot()` commands usually works as a succession of layers or  options that are added to an initial plot specifications. Each extra layer is added after a `+` sign. In the example below, we specify the data and the aesthetic (ie the main parameters of the plot) with the first command: the x and y variables , and the first grouping variable, education). `geom_bar()` stipulates the bar plot, with the ṕosition=\"dodge\" for the bars to be located side by side (position=\"stack\"would have them on top of each other). Finally, facet_wrap() splits the plot by gender.\n\n::: {.cell hash='Graphs_cache/html/7.9_ad9e1ec5e9cbdf2357bd4f2a7e688411'}\n\n```{.r .cell-code}\nggplot(data=pa,aes(y=Percent,x=Affiliation,fill=Education))+\n  geom_bar(position=\"dodge\",stat=\"identity\")+\n  facet_wrap(~Gender)+\n  theme_minimal()+                  ### Theme for visualisation\n  scale_fill_manual(values=c(\"#702082\", \"#008755\"))+ ### Custom colours (optional)\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Graphs_files/figure-html/7.9-1.png){fig-alt='Bar plot of political party affiliation by gender and qualification using ggplot' width=672}\n:::\n:::\n\n\n\\newpage",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}