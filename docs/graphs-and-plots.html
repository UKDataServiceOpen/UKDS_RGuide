<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Graphs and plots |  Analysing survey data using R</title>
  <meta name="description" content="<br />
Analysing survey data using R</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Graphs and plots |  Analysing survey data using R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Graphs and plots |  Analysing survey data using R" />
  
  
  

<meta name="author" content="Pierre Walthéry, Nadia Kennar, Rihab Dahab, UK Data Service" />


<meta name="date" content="2023-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="producing-weighted-estimates.html"/>
<link rel="next" href="statistical-testing.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UKDS Introduction to R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R ?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-r-essential-information.html"><a href="using-r-essential-information.html"><i class="fa fa-check"></i><b>2</b> Using R: essential information</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-r-essential-information.html"><a href="using-r-essential-information.html#download-and-installation"><i class="fa fa-check"></i><b>2.1</b> Download and installation</a></li>
<li class="chapter" data-level="2.2" data-path="using-r-essential-information.html"><a href="using-r-essential-information.html#installing-and-setting-up-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installing and setting up RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="using-r-essential-information.html"><a href="using-r-essential-information.html#interacting-with-r"><i class="fa fa-check"></i><b>2.3</b> Interacting with R</a></li>
<li class="chapter" data-level="2.4" data-path="using-r-essential-information.html"><a href="using-r-essential-information.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>2.4</b> Installing and loading packages</a></li>
<li class="chapter" data-level="2.5" data-path="using-r-essential-information.html"><a href="using-r-essential-information.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.6" data-path="using-r-essential-information.html"><a href="using-r-essential-information.html#objects"><i class="fa fa-check"></i><b>2.6</b> Objects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="opening-ukds-datasets-in-r.html"><a href="opening-ukds-datasets-in-r.html"><i class="fa fa-check"></i><b>3</b> Opening UKDS datasets in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="opening-ukds-datasets-in-r.html"><a href="opening-ukds-datasets-in-r.html#essential-information"><i class="fa fa-check"></i><b>3.1</b> Essential information</a></li>
<li class="chapter" data-level="3.2" data-path="opening-ukds-datasets-in-r.html"><a href="opening-ukds-datasets-in-r.html#the-2017-british-social-attitudes-survey"><i class="fa fa-check"></i><b>3.2</b> The 2017 British Social Attitudes Survey</a></li>
<li class="chapter" data-level="3.3" data-path="opening-ukds-datasets-in-r.html"><a href="opening-ukds-datasets-in-r.html#understanding-the-dataset"><i class="fa fa-check"></i><b>3.3</b> Understanding the dataset</a></li>
<li class="chapter" data-level="3.4" data-path="opening-ukds-datasets-in-r.html"><a href="opening-ukds-datasets-in-r.html#identifying-and-selecting-variables"><i class="fa fa-check"></i><b>3.4</b> Identifying and selecting variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Essentials of Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#creating-and-transforming-numerical-variables"><i class="fa fa-check"></i><b>4.1</b> Creating and transforming numerical variables</a></li>
<li class="chapter" data-level="4.2" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#categorical-variables"><i class="fa fa-check"></i><b>4.2</b> Categorical variables</a></li>
<li class="chapter" data-level="4.3" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#recoding-variables"><i class="fa fa-check"></i><b>4.3</b> Recoding variables</a></li>
<li class="chapter" data-level="4.4" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#missing-values"><i class="fa fa-check"></i><b>4.4</b> Missing Values</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#inspecting-missing-data"><i class="fa fa-check"></i><b>4.4.1</b> Inspecting missing data</a></li>
<li class="chapter" data-level="4.4.2" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#recoding-missing-values-as-na-continuous-variables"><i class="fa fa-check"></i><b>4.4.2</b> Recoding missing values as NA (continuous variables)</a></li>
<li class="chapter" data-level="4.4.3" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#working-with-missing-values"><i class="fa fa-check"></i><b>4.4.3</b> Working with missing values</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="essentials-of-data-manipulation.html"><a href="essentials-of-data-manipulation.html#subsetting-datasets"><i class="fa fa-check"></i><b>4.5</b> Subsetting datasets</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>5</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#continuous-variables"><i class="fa fa-check"></i><b>5.1</b> Continuous variables</a></li>
<li class="chapter" data-level="5.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#bivariate-association-between-continuous-variables"><i class="fa fa-check"></i><b>5.2</b> Bivariate association between continuous variables</a></li>
<li class="chapter" data-level="5.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#categorical-variables-1"><i class="fa fa-check"></i><b>5.3</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#one-way-frequency-tables"><i class="fa fa-check"></i><b>5.3.1</b> One way frequency tables</a></li>
<li class="chapter" data-level="5.3.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#two-way-or-more-contingency-table"><i class="fa fa-check"></i><b>5.3.2</b> Two way or more contingency table</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#grouped-summary-statistics-for-continuous-variables"><i class="fa fa-check"></i><b>5.4</b> Grouped summary statistics for continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="producing-weighted-estimates.html"><a href="producing-weighted-estimates.html"><i class="fa fa-check"></i><b>6</b> Producing weighted estimates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="producing-weighted-estimates.html"><a href="producing-weighted-estimates.html#central-tendency-and-dispersion-continuous-variables"><i class="fa fa-check"></i><b>6.1</b> Central tendency and dispersion (continuous variables)</a></li>
<li class="chapter" data-level="6.2" data-path="producing-weighted-estimates.html"><a href="producing-weighted-estimates.html#frequencies-and-contingency-tables"><i class="fa fa-check"></i><b>6.2</b> Frequencies and contingency tables</a></li>
<li class="chapter" data-level="6.3" data-path="producing-weighted-estimates.html"><a href="producing-weighted-estimates.html#robust-inference"><i class="fa fa-check"></i><b>6.3</b> Robust inference</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphs-and-plots.html"><a href="graphs-and-plots.html"><i class="fa fa-check"></i><b>7</b> Graphs and plots</a>
<ul>
<li class="chapter" data-level="7.1" data-path="graphs-and-plots.html"><a href="graphs-and-plots.html#distributional-graphs-for-continuous-variables"><i class="fa fa-check"></i><b>7.1</b> Distributional graphs for continuous variables</a></li>
<li class="chapter" data-level="7.2" data-path="graphs-and-plots.html"><a href="graphs-and-plots.html#plotting-categorical-variables"><i class="fa fa-check"></i><b>7.2</b> Plotting categorical variables</a></li>
<li class="chapter" data-level="7.3" data-path="graphs-and-plots.html"><a href="graphs-and-plots.html#more-advanced-plots"><i class="fa fa-check"></i><b>7.3</b> More advanced plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="statistical-testing.html"><a href="statistical-testing.html"><i class="fa fa-check"></i><b>8</b> Statistical testing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="statistical-testing.html"><a href="statistical-testing.html#differences-in-means"><i class="fa fa-check"></i><b>8.1</b> Differences in means</a></li>
<li class="chapter" data-level="8.2" data-path="statistical-testing.html"><a href="statistical-testing.html#differences-in-variance"><i class="fa fa-check"></i><b>8.2</b> Differences in variance</a></li>
<li class="chapter" data-level="8.3" data-path="statistical-testing.html"><a href="statistical-testing.html#significance-of-measures-of-association"><i class="fa fa-check"></i><b>8.3</b> Significance of measures of association</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i><b>9</b> Regression analysis</a></li>
<li class="chapter" data-level="10" data-path="further-information.html"><a href="further-information.html"><i class="fa fa-check"></i><b>10</b> Further information</a>
<ul>
<li class="chapter" data-level="10.1" data-path="further-information.html"><a href="further-information.html#additional-commands-of-interest"><i class="fa fa-check"></i><b>10.1</b> Additional commands of interest</a></li>
<li class="chapter" data-level="10.2" data-path="further-information.html"><a href="further-information.html#additional-online-resources"><i class="fa fa-check"></i><b>10.2</b> Additional online resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
<li class="divider"></li>
<li><a href="https://ukdataservice.ac.uk" target="blank">UK Data Service</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="pics/UKDS_Logos_Col_Grey_300dpi.png" style="width:6cm" /><br />
Analysing survey data using R</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphs-and-plots" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Graphs and plots<a href="graphs-and-plots.html#graphs-and-plots" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>There are two main ways to produce graphs in R: either by using the straightforward but rather basic plotting commands from the Base package, or the more complex and nicer looking functions from the <code>ggplot</code> package.</p>
<div id="distributional-graphs-for-continuous-variables" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Distributional graphs for continuous variables<a href="graphs-and-plots.html#distributional-graphs-for-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Graphs such as histograms or box plots are a convenient way to gain a quick overview of the distribution of a variable and are easy to produce. Go back to the BSA data, we can plot the distribution of left-right political orientations scores with the <code>hist()</code> command.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="graphs-and-plots.html#cb208-1" tabindex="-1"></a><span class="fu">hist</span>(bsa<span class="sc">$</span>leftrigh,<span class="at">freq=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.1-1.png" alt="Unformatted histogram of left-right political orientations scores" width="672" /></p>
<p>The graphs appear visible in the ‘Plot’ tab on the right hand side of the R Studio window. It shows us that political orientations are slightly skewed towards the left. The <code>freq=FALSE</code> option requires the y-axis to be expressed in terms of proportions rather than frequencies.</p>
<p>Titles and labels can easily be added:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="graphs-and-plots.html#cb209-1" tabindex="-1"></a><span class="fu">hist</span>(bsa<span class="sc">$</span>leftrigh,</span>
<span id="cb209-2"><a href="graphs-and-plots.html#cb209-2" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">FALSE</span>,</span>
<span id="cb209-3"><a href="graphs-and-plots.html#cb209-3" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Histogram of political orientations&quot;</span>,</span>
<span id="cb209-4"><a href="graphs-and-plots.html#cb209-4" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Proportions&quot;</span>,</span>
<span id="cb209-5"><a href="graphs-and-plots.html#cb209-5" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Left-right political orientations score&quot;</span>)</span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.2-1.png" alt="Histogram of left vs right political orientations, with title and y axis labels" width="672" /></p>
<p>Note that <code>main</code>, <code>ylab</code> and <code>xlab</code> can be used with any Base R plot commands.</p>
<p>We can also produce a box and whisker plot of the same variable:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="graphs-and-plots.html#cb210-1" tabindex="-1"></a><span class="fu">boxplot</span>(bsa<span class="sc">$</span>leftrigh,</span>
<span id="cb210-2"><a href="graphs-and-plots.html#cb210-2" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&quot;Box and whisker plot of political orientations&quot;</span>,</span>
<span id="cb210-3"><a href="graphs-and-plots.html#cb210-3" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Left-right political orientations score&quot;</span></span>
<span id="cb210-4"><a href="graphs-and-plots.html#cb210-4" tabindex="-1"></a>        )</span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.3-1.png" alt="Box and whisker plot of left vs right political orientations, with title and y axis labels" width="672" /></p>
<p>The generic <code>plot()</code> command produces one or two-way scatterplots:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="graphs-and-plots.html#cb211-1" tabindex="-1"></a><span class="fu">plot</span>(bsa<span class="sc">$</span>leftrigh)             <span class="do">### One way scatter plot of left-right political orientations score</span></span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.4.1-1.png" alt="Raw scatterplot of left-right political orientations" width="672" /></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="graphs-and-plots.html#cb212-1" tabindex="-1"></a><span class="fu">plot</span>(bsa<span class="sc">$</span>leftrigh,bsa<span class="sc">$</span>libauth) <span class="do">### Two-way scatterplot of political orientations by authoritarianism score</span></span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.4.2-1.png" alt="Raw scatterplot of left-right political orientations vs degree of authoritarianism" width="672" /></p>
<p>The second graph shows us that there is little association between the two variables. However, slightly fewer respondents simultaneously score high on the authoritarianism and left vs right scales.</p>
</div>
<div id="plotting-categorical-variables" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Plotting categorical variables<a href="graphs-and-plots.html#plotting-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The generic <code>plot()</code> function provides a quick way to produce bar plots of categorical data. For example, we can examine the distribution of political party affiliations (<code>Politics</code> variable) which is a factor (ie categorical) variable. Some preliminary abbreviating of the factor levels are required in order for them to be displayed properly.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="graphs-and-plots.html#cb213-1" tabindex="-1"></a><span class="fu">levels</span>(bsa<span class="sc">$</span>PartyId2) <span class="do">## The third and fourth factor levels are a bit long</span></span></code></pre></div>
<pre><code>## [1] &quot;Conservative&quot;     &quot;Labour&quot;          
## [3] &quot;Liberal Democrat&quot; &quot;Other party&quot;     
## [5] &quot;None&quot;             &quot;Green Party&quot;</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="graphs-and-plots.html#cb215-1" tabindex="-1"></a><span class="fu">levels</span>(bsa<span class="sc">$</span>PartyId2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Con&quot;</span>,<span class="st">&quot;Lab&quot;</span>,<span class="st">&quot;Lib Dems&quot;</span>,<span class="st">&quot;Other&quot;</span>,<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Greens&quot;</span>) </span>
<span id="cb215-2"><a href="graphs-and-plots.html#cb215-2" tabindex="-1"></a><span class="fu">plot</span>(bsa<span class="sc">$</span>PartyId2)</span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.5-1.png" alt="Default frequency bar plot of political party affiliation using the plot command" width="672" />
More advanced plots require the barplot() function, which can be used in conjunction with table(). Whereas table() creates the data that will be plotted, barplot() does the actual plotting. For instance, we can produce the same bar plot, but this time with percentages, by creating a frequency table as we did above in Section 5.2, then plot it.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="graphs-and-plots.html#cb216-1" tabindex="-1"></a>party.tab<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(</span>
<span id="cb216-2"><a href="graphs-and-plots.html#cb216-2" tabindex="-1"></a>  <span class="fu">table</span>(bsa<span class="sc">$</span>PartyId2)</span>
<span id="cb216-3"><a href="graphs-and-plots.html#cb216-3" tabindex="-1"></a>),</span>
<span id="cb216-4"><a href="graphs-and-plots.html#cb216-4" tabindex="-1"></a><span class="dv">1</span>)</span>
<span id="cb216-5"><a href="graphs-and-plots.html#cb216-5" tabindex="-1"></a></span>
<span id="cb216-6"><a href="graphs-and-plots.html#cb216-6" tabindex="-1"></a>party.tab</span></code></pre></div>
<pre><code>## 
##      Con      Lab Lib Dems    Other     None   Greens 
##     33.5     39.2      6.4      5.1     13.7      2.1</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="graphs-and-plots.html#cb218-1" tabindex="-1"></a><span class="fu">barplot</span>(party.tab,</span>
<span id="cb218-2"><a href="graphs-and-plots.html#cb218-2" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;Political party affiliation&quot;</span>,</span>
<span id="cb218-3"><a href="graphs-and-plots.html#cb218-3" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Percent&quot;</span>)</span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.6-1.png" alt="Neater frequency bar plot of political party affiliation using the barplot command" width="672" /></p>
<p>We can go further and create plots for two way contingency tables of party affiliation by gender. This time we will do it in a single command:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="graphs-and-plots.html#cb219-1" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb219-2"><a href="graphs-and-plots.html#cb219-2" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(</span>
<span id="cb219-3"><a href="graphs-and-plots.html#cb219-3" tabindex="-1"></a>  <span class="fu">table</span>(bsa<span class="sc">$</span>Rsex,bsa<span class="sc">$</span>PartyId2),</span>
<span id="cb219-4"><a href="graphs-and-plots.html#cb219-4" tabindex="-1"></a><span class="dv">2</span>),                              <span class="do">## Column % (here, gender)</span></span>
<span id="cb219-5"><a href="graphs-and-plots.html#cb219-5" tabindex="-1"></a><span class="dv">1</span>),                               <span class="do">## Rounded to 1 decimal</span></span>
<span id="cb219-6"><a href="graphs-and-plots.html#cb219-6" tabindex="-1"></a><span class="at">beside =</span> T,                     <span class="do">## Side-by-side bars   </span></span>
<span id="cb219-7"><a href="graphs-and-plots.html#cb219-7" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Political party affiliation by gender&quot;</span>,</span>
<span id="cb219-8"><a href="graphs-and-plots.html#cb219-8" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Percent&quot;</span>)</span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.7-1.png" alt="Two-way frequency bar plot of political party affiliation by gender using the barplot command" width="672" /></p>
</div>
<div id="more-advanced-plots" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> More advanced plots<a href="graphs-and-plots.html#more-advanced-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Social science research often requires more advanced plots in order to conduct more complex analyses, for instance comparing the mean or median value of a continuous outcome across two or more categorical variables. The <code>ggplot</code> package provides one of the most advanced set of tools for plotting data currently available. A few examples are provided below.</p>
<p><strong><em>Political party affiliation by highest qualification and gender</em></strong>
We would like to look at how differences in political party affiliations vary by gender and whether respondents have a degree-level education.</p>
<p>Let us first prepare the data: we need to create the table of result, the proportion of degree vs non degree holders by gender and political party. This is a three-way contingency table, that we can obtain with <code>ftable()</code> as shown in Section 5.2, combined with <code>prop.table()</code> for the computation of proportions and <code>round()</code>.
As they are more straightforward to handle in <code>ggplot</code>, we convert the table object created by ftable into a data frame. Although we can specify titles and axis labels in the plotting command, it is preferable to keep things simple here and have them already in the the data.<br />
Rather than using the full range of educational achievements recorded in <code>HEdQual3</code>, we would like instead to have a dichotomic variable between degree holders and non degree holders. Adding it directly in the ftable command as a boolean expression return a dichotomic variable: “TRUE” for Degree educated respondents, and “FALSE” for everyone else. We just need to change the levels of this factor variable to make them more intelligible. Finally we change the variable names in our data frame.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="graphs-and-plots.html#cb220-1" tabindex="-1"></a>pa<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>((<span class="fu">ftable</span>(bsa<span class="sc">$</span>PartyId2,bsa<span class="sc">$</span>Rsex,(bsa<span class="sc">$</span>HEdQual3<span class="sc">==</span><span class="st">&quot;Degree&quot;</span>))),<span class="dv">1</span>),<span class="dv">1</span>)</span>
<span id="cb220-2"><a href="graphs-and-plots.html#cb220-2" tabindex="-1"></a>pa<span class="ot">&lt;-</span><span class="fu">data.frame</span>(pa)</span>
<span id="cb220-3"><a href="graphs-and-plots.html#cb220-3" tabindex="-1"></a><span class="fu">levels</span>(pa<span class="sc">$</span>Var3)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Below&quot;</span>,<span class="st">&quot;Degree&quot;</span>)</span>
<span id="cb220-4"><a href="graphs-and-plots.html#cb220-4" tabindex="-1"></a><span class="fu">names</span>(pa)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Affiliation&quot;</span>,<span class="st">&quot;Gender&quot;</span>,<span class="st">&quot;Education&quot;</span>,<span class="st">&quot;Percent&quot;</span>)</span>
<span id="cb220-5"><a href="graphs-and-plots.html#cb220-5" tabindex="-1"></a>pa</span></code></pre></div>
<pre><code>##    Affiliation Gender Education Percent
## 1          Con   Male     Below    72.7
## 2          Lab   Male     Below    70.1
## 3     Lib Dems   Male     Below    50.0
## 4        Other   Male     Below    86.5
## 5         None   Male     Below    88.8
## 6       Greens   Male     Below    43.3
## 7          Con Female     Below    82.6
## 8          Lab Female     Below    67.3
## 9     Lib Dems Female     Below    54.4
## 10       Other Female     Below    74.7
## 11        None Female     Below    83.9
## 12      Greens Female     Below    48.9
## 13         Con   Male    Degree    27.3
## 14         Lab   Male    Degree    29.9
## 15    Lib Dems   Male    Degree    50.0
## 16       Other   Male    Degree    13.5
## 17        None   Male    Degree    11.2
## 18      Greens   Male    Degree    56.7
## 19         Con Female    Degree    17.4
## 20         Lab Female    Degree    32.7
## 21    Lib Dems Female    Degree    45.6
## 22       Other Female    Degree    25.3
## 23        None Female    Degree    16.1
## 24      Greens Female    Degree    51.1</code></pre>
<p>We are now ready to plot the data. the <code>ggplot()</code> commands usually works as a succession of layers or options that are added to an initial plot specifications. Each extra layer is added after a <code>+</code> sign. In the example below, we specify the data and the aesthetic (ie the main parameters of the plot) with the first command: the x and y variables , and the first grouping variable, education). <code>geom_bar()</code> stipulates the bar plot, with the ṕosition=“dodge” for the bars to be located side by side (position=“stack”would have them on top of each other). Finally, facet_wrap() splits the plot by gender.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="graphs-and-plots.html#cb222-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pa,<span class="fu">aes</span>(<span class="at">y=</span>Percent,<span class="at">x=</span>Affiliation,<span class="at">fill=</span>Education))<span class="sc">+</span></span>
<span id="cb222-2"><a href="graphs-and-plots.html#cb222-2" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>,<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb222-3"><a href="graphs-and-plots.html#cb222-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Gender)<span class="sc">+</span></span>
<span id="cb222-4"><a href="graphs-and-plots.html#cb222-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span>                                  <span class="do">### Theme for visualisation</span></span>
<span id="cb222-5"><a href="graphs-and-plots.html#cb222-5" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#702082&quot;</span>, <span class="st">&quot;#008755&quot;</span>)) <span class="do">### Manually specifying the colours (optional)</span></span></code></pre></div>
<p><img src="UKDS-intro-to-R_files/figure-html/7.9-1.png" alt="Bar plot of political party affiliation by gender and qualification using ggplot" width="672" />
</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="producing-weighted-estimates.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
